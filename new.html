<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Location Detector</title>
</head>
<body>
  <h1>Detect My Location</h1>
  <button id="getLocation">Detect</button>
  <div id="location"></div>
  <div id="error" style="color:red;"></div>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwInXFQirWnE-DmaPYRA5gzGkfc-_I66Tl0nIFzvDNQvYvrv7yqwMJRYjwfdJzu2O8q/exec"; // Thay báº±ng URL cá»§a báº¡n

    document.getElementById("getLocation").addEventListener("click", () => {
      const locationDiv = document.getElementById("location");
      const errorDiv = document.getElementById("error");
      locationDiv.innerHTML = "";
      errorDiv.innerHTML = "";

      if (!navigator.geolocation) {
        errorDiv.textContent = "Geolocation is not supported by your browser.";
        return;
      }

      navigator.geolocation.getCurrentPosition(async (pos) => {
        const lat = pos.coords.latitude;
        const lon = pos.coords.longitude;

        locationDiv.innerHTML = `Latitude: ${lat}, Longitude: ${lon}`;

        try {
          // Láº¥y Ä‘á»‹a chá»‰ tá»« OpenStreetMap
          const response = await fetch(
            `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`
          );
          const data = await response.json();
          const address = data.display_name || "Unknown";

          locationDiv.innerHTML += `<br>Address: ${address}`;

          // ðŸ‘‰ Gá»­i vÃ o Google Sheets
          await fetch(SCRIPT_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ latitude: lat, longitude: lon, address })
          });
        } catch (err) {
          errorDiv.textContent = "Error fetching address or sending data.";
          console.error(err);
        }
      }, (error) => {
        errorDiv.textContent = "Error getting location: " + error.message;
      });
    });
  </script>
</body>
</html>
